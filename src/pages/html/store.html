<html lang="zh-CN"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://cdn.tailwindcss.com">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="preconnect" href="https://p26-doubao-search-sign.byteimg.com">
  <title>Zayck ã® å°åº—</title>
  <link rel="icon" href="/goat.png" type="image/png">
  <script src="https://cdn.tailwindcss.com"></script> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#557937',
            secondary: '#FFA149',
            dark: '#373B2F',
            light: '#F5F5F5',
            accent: '#FFD166',
          },
          fontFamily: {
            sans: ['system-ui', 'sans-serif'], // ç§»é™¤Interå­—ä½“å¼•ç”¨
          },
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
          }
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }
      .card-hover {
        @apply transition-all duration-300 hover:shadow-lg hover:-translate-y-1;
      }
      @keyframes fadeUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      @media (min-width: 768px) {
        .fade-up-animation { animation: fadeUp 0.8s ease-out forwards; }
        .fade-up-animation:nth-child(2n) { animation-delay: 0.1s; }
        .fade-up-animation:nth-child(3n) { animation-delay: 0.2s; }
        .fade-up-animation:nth-child(4n) { animation-delay: 0.3s; }
      }
      .btn-primary {
        @apply bg-primary text-white px-4 py-2 rounded-full hover:bg-secondary transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50;
      }
      .btn-secondary {
        @apply bg-white text-primary border border-primary px-4 py-2 rounded-full hover:bg-light transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50;
      }
      .input-primary {
        @apply border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent;
      }
      .badge {
        @apply absolute -top-2 -right-2 bg-primary text-white text-xs rounded-full w-5 h-5 flex items-center justify-center;
      }
      .drawer {
        transform: translateX(100%);
        transition: transform 0.3s ease-in-out;
      }
      .drawer.open {
        transform: translateX(0);
      }
      .countdown {
        @apply font-mono text-lg font-bold text-primary;
      }
    }
  </style>
</head>
<body class="bg-light font-sans text-dark">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center">
        <h1 class="text-2xl font-bold text-primary">
          <img src="/goat.png" class="w-8 h-8 mr-2 inline-block">Zayck ã® å°åº—
        </h1>
      </div>
      
      <div class="flex items-center space-x-4">
        <button id="cart-button" class="relative p-2 rounded-full hover:bg-gray-100 transition-colors">
          <i style="font-size: 24px; padding: 4px; border-radius: 4px;">ğŸ›’</i>
          <span id="cart-count" class="badge">0</span>
        </button>
      </div>
    </div>
  </header>

  <!-- ä¸»å†…å®¹åŒº -->
  <main class="container mx-auto px-4 py-6">
    <!-- è‹±é›„åŒº -->
    <section class="relative rounded-2xl overflow-hidden mb-8" data-aos="fade-up">
      <img src="https://p9-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/code_assistant/7336f94f89a846679bba8a784b3a8b3c~tplv-a9rns2rl98-image.image?rcl=20250922155240777E2CA375183D6CC390&amp;rk3s=8e244e95&amp;rrcfp=2609e108&amp;x-expires=1759132365&amp;x-signature=yIb2ntHbmKduFsKe%2F5AXh0MrqZA%3D" alt="æ±‰å ¡å¥—é¤" class="w-full h-[280px] object-cover" loading="lazy">
      <div class="absolute inset-0 z-20 flex flex-col justify-center items-center text-white text-center px-4">
        <h2 class="text-4xl font-bold mb-4" style="font-size: 36px;">ç¾å‘³å¿«é¤ æ€¥é€Ÿé€è¾¾</h2>
        <p class="text-xl mb-6 max-w-md">æ–°é²œé£Ÿæï¼Œç°ç‚¹ç°åšï¼Œ30åˆ†é’Ÿå†…é€è¾¾æ‚¨çš„æ‰‹ä¸­</p>
        <button class="btn-primary px-8 py-3 text-lg" onclick="document.getElementById('menu-categories').scrollIntoView({ behavior: 'smooth' })">ç«‹å³é€‰è´­</button>
      </div>
    </section>

    <!-- èœå•åˆ†ç±» -->
    <section id="menu-categories" class="mb-8 scroll-mt-20" data-aos="fade-up" data-aos-delay="100">
      <div class="flex overflow-x-auto pb-2 space-x-2">
      </div>
    </section>

    <!-- èœå•åˆ—è¡¨ -->
    <section class="mb-12" data-aos="fade-up" data-aos-delay="200">
      <div id="menu-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      </div>
    </section>

    <!-- è®¢å•ç¡®è®¤å€’è®¡æ—¶ -->
    <section id="countdown-section" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
      <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4" data-aos="zoom-in">
        <div class="text-center">
          <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-yellow-100 mb-4">
            <i class="fa fa-lightbulb-o text-yellow-500 text-4xl"></i>
          </div>
          <h2 class="text-2xl font-bold mb-2">è®¢å•æäº¤æˆåŠŸï¼</h2>

          <div id="payment-section" class="mb-6">
            <h3 class="text-lg font-medium mb-3">è¯·æ”¯ä»˜ï¼š<span id="payment-amount" class="text-primary font-bold"></span></h3>
            <div class="flex justify-center items-center p-4 bg-white border rounded-lg">
              <img id="alipay-qrcode" src="" alt="æ”¯ä»˜å®æ”¶æ¬¾ç " class="w-48 h-48 object-contain">
            </div>
            <p class="text-sm text-gray-500 mt-2">è¯·ä½¿ç”¨æ”¯ä»˜å®æ‰«æäºŒç»´ç ä»˜æ¬¾</p>
          </div>
          
          <div class="bg-light rounded-lg p-4 mb-6">
            <p class="text-gray-700 mb-2">è®¢å•å°†åœ¨ <span id="countdown-timer" class="countdown">5:00</span> åè‡ªåŠ¨å–æ¶ˆ</p>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
              <div id="countdown-progress" class="bg-primary h-2.5 rounded-full" style="width: 100%"></div>
            </div>
          </div>
          
          <div class="flex space-x-4">
            <button id="cancel-order-btn" class="btn-secondary flex-1">å–æ¶ˆè®¢å•</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- å³ä¸‹è§’å›ºå®šæŒ‰é’® -->
    <div class="fixed right-6 bottom-6 flex flex-col gap-4 z-40">
    <!-- ç»“ç®—æŒ‰é’® -->
    <button id="checkout-fixed-btn" class="relative w-12 h-12 rounded-full bg-primary text-white flex items-center justify-center shadow-lg hover:bg-secondary transition-colors duration-300">
        ç»“ç®—
        <span id="cart-count-fixed" class="badge">0</span>
    </button>
    <!-- å›åˆ°é¡¶ç«¯æŒ‰é’® -->
    <button id="back-to-top-btn" class="w-12 h-12 rounded-full bg-primary text-white flex items-center justify-center shadow-lg hover:bg-secondary transition-colors duration-300">
        <i class="fa fa-arrow-up"></i>
    </button>
    </div>

  <!-- è´­ç‰©è½¦æŠ½å±‰ -->
  <div id="cart-drawer" class="drawer fixed top-0 right-0 h-full w-full sm:w-96 bg-white shadow-xl z-50 flex flex-col">
    <div class="p-4 border-b flex justify-between items-center">
      <h2 class="text-xl font-bold">è´­ç‰©è½¦</h2>
      <button id="close-cart-btn" class="p-2 rounded-full hover:bg-gray-100">
        <i class="fa fa-times"></i>
      </button>
    </div>
    
    <div id="cart-items" class="flex-1 overflow-y-auto p-4 space-y-4">
      <div id="empty-cart" class="flex flex-col items-center justify-center h-full">
        <i class="fa fa-shopping-cart text-gray-300 text-5xl mb-4"></i>
        <p class="text-gray-500">è´­ç‰©è½¦è¿˜æ˜¯ç©ºçš„</p>
        <button id="start-shopping-btn" class="btn-primary mt-4">å¼€å§‹è´­ç‰©</button>
      </div>
      <!-- è´­ç‰©è½¦å•†å“åˆ—è¡¨ -->
      <div id="cart-list" class="hidden space-y-4">
      </div>
    </div>
    
    <div id="cart-summary" class="hidden p-4 border-t">
      <div class="flex justify-between mb-2">
        <span>å•†å“æ€»ä»·</span>
        <span id="subtotal">Â¥0.00</span>
      </div>
      <div class="flex justify-between font-bold text-lg mt-4">
        <span>æ€»è®¡</span>
        <span id="total">Â¥0.00</span>
      </div>
      <button id="checkout-btn" class="btn-primary w-full mt-4 py-3">å»ç»“ç®—</button>
    </div>
  </div>

  <!-- é®ç½©å±‚ -->
  <div id="overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40"></div>
  <script>
  // åˆå§‹åŒ–AOSåŠ¨ç”»åº“
  document.addEventListener('DOMContentLoaded', async function() {
    await fetchMenuData();
    initializeEventListeners();
    // ä½¿ç”¨requestAnimationFrameå»¶è¿Ÿæ‰§è¡Œï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹
    requestAnimationFrame(() => {
      if (typeof AOS !== 'undefined' && window.innerWidth > 768) {
        AOS.init({
          duration: 800,
          once: true
        });
      }
    });
  });
window.addEventListener('error', function(e) {
});

// èœå•æ•°æ®
let menuItems = [];

// ç¼“å­˜DOMå…ƒç´ å¼•ç”¨
let DOM = {};

  // ä»ç»´æ ¼è¡¨APIè·å–èœå•æ•°æ®
  async function fetchMenuData() {
    const vikaBaseUrl = 'https://api.vika.cn/fusion/v1/datasheets/';
    const datasheetId = 'dstZNfY63e1docCUdz';
    const apiToken = 'uskekHX5zWy8J4cXf2Ih8kn';
    const cacheKey = 'menuData';
    const cacheExpiry = 3600000; // ç¼“å­˜æœ‰æ•ˆæœŸ1å°æ—¶ï¼ˆæ¯«ç§’ï¼‰
    
    // æ£€æŸ¥æœ¬åœ°å­˜å‚¨æ˜¯å¦æœ‰ç¼“å­˜æ•°æ®
    const cachedData = localStorage.getItem(cacheKey);
    const cachedTime = localStorage.getItem(`${cacheKey}_time`);
    
    if (cachedData && cachedTime && (Date.now() - parseInt(cachedTime)) < cacheExpiry) {
      menuItems = JSON.parse(cachedData);
      renderMenu();
      return;
    }
    
    try {
      // æ·»åŠ è¯·æ±‚è¶…æ—¶å¤„ç†
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 10000); // 10ç§’è¶…æ—¶
      
      const response = await fetch(`${vikaBaseUrl}${datasheetId}/records`, {
        method: 'GET',
        headers: {
          'Authorization': `Bearer ${apiToken}`,
          'Content-Type': 'application/json'
        },
        signal: controller.signal
      });
      
      clearTimeout(timeoutId);
      
      if (!response.ok) {
        const errorText = await response.text();
        throw new Error(`HTTP error! Status: ${response.status}, Message: ${errorText}`);
      }
      
      const data = await response.json();
      let records = [];
      
      if (data && data.data && data.data.records && Array.isArray(data.data.records)) {
        records = data.data.records;
      } else if (data && data.records && Array.isArray(data.records)) {
        records = data.records;
      } else if (data && Array.isArray(data)) {
        records = data;
      } else {
        for (const key in data) {
          if (Array.isArray(data[key])) {
            records = data[key];
            break;
          }
        }
      }
      
      if (records.length === 0) {
        throw new Error('APIè¿”å›çš„æ•°æ®ä¸­æ²¡æœ‰æ‰¾åˆ°è®°å½•æ•°ç»„');
      }
      
      // è§£æç»´æ ¼è¡¨æ•°æ®
      menuItems = records.map(record => {
        const fields = record.fields || record;
        
        let category = '';
        if (Array.isArray(fields.category) && fields.category.length > 0) {
          category = fields.category[0];
        } else if (fields.category) {
          category = fields.category;
        }
        
        // æå–å›¾ç‰‡URL
        let image = '';
        if (fields.image && typeof fields.image === 'object') {
          image = fields.image.text || fields.image.title || '';
        } else if (fields.image) {
          image = fields.image;
        }
        return {
          id: record.recordId || fields.id || Date.now() + Math.random(),
          name: fields.name || fields.title || '',
          category: category || fields.type || '',
          description: fields.description || fields.desc || '',
          price: fields.price || fields.cost || 0,
          image: image || fields.img || ''
        };
      });
      generateCategoryButtons();
      initializeMenu();
    } catch (error) {
      const menuContainer = document.getElementById('menu-container');
      if (menuContainer) {
        menuContainer.innerHTML = '<div style="text-align: center; padding: 20px;">æ— æ³•åŠ è½½èœå•æ•°æ®ï¼Œè¯·ç¨åé‡è¯•</div>';
      }
      menuItems = [];
    }
  }

// ç”Ÿæˆåˆ†ç±»æŒ‰é’®å‡½æ•°
function generateCategoryButtons() {
  const categoryButtonsContainer = document.querySelector('#menu-categories .flex');
  if (!categoryButtonsContainer) {
    return;
  }
  const allButton = categoryButtonsContainer.querySelector('[data-category="all"]');
  if (allButton) {
    categoryButtonsContainer.innerHTML = '';
    categoryButtonsContainer.appendChild(allButton);
  } else {
    categoryButtonsContainer.innerHTML = '';
    const newAllButton = document.createElement('button');
    newAllButton.className = 'category-btn whitespace-nowrap px-6 py-2 rounded-full bg-primary text-white active';
    newAllButton.dataset.category = 'all';
    newAllButton.textContent = 'å…¨éƒ¨';
    categoryButtonsContainer.appendChild(newAllButton);
  }
  
  // ä»èœå•é¡¹ä¸­æå–æ‰€æœ‰å”¯ä¸€åˆ†ç±»
  const categoriesSet = new Set();
  menuItems.forEach(item => {
    if (item.category && item.category.trim() !== '') {
      categoriesSet.add(item.category.trim());
    }
  });
  
  const categories = Array.from(categoriesSet).sort();
  
  // åŠ¨æ€ç”Ÿæˆåˆ†ç±»æŒ‰é’®
  categories.forEach(category => {
    const button = document.createElement('button');
    button.className = 'category-btn whitespace-nowrap px-6 py-2 rounded-full bg-primary bg-opacity-20 hover:bg-opacity-30 text-primary';
    button.dataset.category = category;
    button.textContent = category;
    categoryButtonsContainer.appendChild(button);
  });
  bindCategoryButtonListeners();
}
    
  // ç»‘å®šåˆ†ç±»æŒ‰é’®äº‹ä»¶ç›‘å¬
  function bindCategoryButtonListeners() {
    const categoryButtons = document.querySelectorAll('.category-btn');
    categoryButtons.forEach(button => {
      button.removeEventListener('click', handleCategoryClick);
      button.addEventListener('click', handleCategoryClick);
    });
  }
  
// åˆ†ç±»æŒ‰é’®ç‚¹å‡»å¤„ç†å‡½æ•°
function handleCategoryClick() {
  const categoryButtons = document.querySelectorAll('.category-btn');
  categoryButtons.forEach(btn => {
    btn.classList.remove('active', 'bg-primary', 'text-white');
    btn.classList.add('bg-primary', 'bg-opacity-20', 'text-primary');
  });
  this.classList.add('active', 'bg-primary', 'text-white');
  this.classList.remove('bg-opacity-20');
  
  const category = this.dataset.category;
  filterMenu(category);
}

  // è´­ç‰©è½¦æ•°æ®
  let cart = [];

  // åˆå§‹åŒ–èœå•
  function initializeMenu() {
      const menuContainer = document.getElementById('menu-container');
      if (!menuContainer) {
        return;
      }
      menuContainer.innerHTML = '';
      if (menuItems.length === 0) {
        return;
      }
      
      // ä½¿ç”¨æ–‡æ¡£ç‰‡æ®µæ‰¹é‡æ·»åŠ å…ƒç´ 
      const fragment = document.createDocumentFragment();
      menuItems.forEach(item => {
        const menuItem = createMenuItem(item);
        fragment.appendChild(menuItem);
      });
      menuContainer.appendChild(fragment);
    }

    // åˆ›å»ºèœå•é¡¹
    function createMenuItem(item) {
      const menuItem = document.createElement('div');
      menuItem.className = `menu-item card-hover bg-white rounded-xl shadow overflow-hidden ${item.category} fade-up-animation`;
      menuItem.setAttribute('data-category', item.category);
      menuItem.innerHTML = `
        <div class="relative overflow-hidden rounded-lg">
          <img src="${item.image}" alt="${item.name}" class="w-full h-48 object-cover" loading="lazy" onerror="this.src='/goat.png'">
          <span class="absolute top-2 right-2 bg-primary text-white text-sm px-2 py-1 rounded-full">
          Â¥${item.price.toFixed(2)}
        </span>
        </div>
        <div class="p-4">
          <div class="mb-2">
            <h3 class="text-lg font-semibold">${item.name}</h3>
          </div>
          <p class="text-gray-600 text-sm mb-4">${item.description}</p>
          <button class="add-to-cart-btn btn-primary w-full" data-id="${item.id}">
            <i class="fa fa-plus mr-1"></i> åŠ å…¥è´­ç‰©è½¦
          </button>
        </div>
      `;
      return menuItem;
    }
    // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
    function initializeEventListeners() {
        // ç¼“å­˜DOMå…ƒç´ å¼•ç”¨
        DOM = {
          cartButton: document.getElementById('cart-button'),
          closeCartBtn: document.getElementById('close-cart-btn'),
          startShoppingBtn: document.getElementById('start-shopping-btn'),
          checkoutFixedBtn: document.getElementById('checkout-fixed-btn'),
          backToTopBtn: document.getElementById('back-to-top-btn'),
          checkoutBtn: document.getElementById('checkout-btn'),
          cancelOrderBtn: document.getElementById('cancel-order-btn'),
          overlay: document.getElementById('overlay'),
          cartDrawer: document.getElementById('cart-drawer'),
          countdownSection: document.getElementById('countdown-section')
        };
        // ä½¿ç”¨ç¼“å­˜çš„DOMå…ƒç´ 
        DOM.cartButton.addEventListener('click', openCart);
        DOM.closeCartBtn.addEventListener('click', closeCart);
        DOM.startShoppingBtn.addEventListener('click', closeCart);
        DOM.checkoutFixedBtn.addEventListener('click', openCart);
        DOM.backToTopBtn.addEventListener('click', function() {
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        });
        DOM.checkoutBtn.addEventListener('click', function() {
          closeCart();
          DOM.countdownSection.classList.remove('hidden');
          startCountdown(); 
        });
        DOM.cancelOrderBtn.addEventListener('click', function() {
          DOM.countdownSection.classList.add('hidden');
          resetCountdown();
        });
        DOM.overlay.addEventListener('click', closeCart);

      // åŠ å…¥è´­ç‰©è½¦æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('add-to-cart-btn') || e.target.parentElement.classList.contains('add-to-cart-btn')) {
          const btn = e.target.classList.contains('add-to-cart-btn') ? e.target : e.target.parentElement;
          const itemId = btn.getAttribute('data-id');
          addToCart(itemId);
        }
      });
      
      // è´­ç‰©è½¦æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.getElementById('cart-button').addEventListener('click', function() {
        openCart();
      });
      
      // å…³é—­è´­ç‰©è½¦æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.getElementById('close-cart-btn').addEventListener('click', function() {
        closeCart();
      });
      
      // å¼€å§‹è´­ç‰©æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.getElementById('start-shopping-btn').addEventListener('click', function() {
        closeCart();
      });

      // å³ä¸‹è§’ç»“ç®—æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.getElementById('checkout-fixed-btn').addEventListener('click', function() {
        openCart();
      });
      
      // å›åˆ°é¡¶ç«¯æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.getElementById('back-to-top-btn').addEventListener('click', function() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });      
      
      // å»ç»“ç®—æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.getElementById('checkout-btn').addEventListener('click', function() {
        closeCart();
        document.getElementById('countdown-section').classList.remove('hidden');
        startCountdown(); 
      });
      
      // å–æ¶ˆè®¢å•æŒ‰é’®ç‚¹å‡»äº‹ä»¶
      document.getElementById('cancel-order-btn').addEventListener('click', function() {
        document.getElementById('countdown-section').classList.add('hidden');
        resetCountdown();
      });
      
      // é®ç½©å±‚ç‚¹å‡»äº‹ä»¶
      document.getElementById('overlay').addEventListener('click', function() {
        closeCart();
      });
  }

    // ç­›é€‰èœå•
    function filterMenu(category) {
      const menuItems = document.querySelectorAll('.menu-item');
      menuItems.forEach(item => {
        if (category === 'all' || item.getAttribute('data-category') === category) {
          item.style.display = 'block';
        } else {
          item.style.display = 'none';
        }
      });
    }

    // æ·»åŠ åˆ°è´­ç‰©è½¦
    function addToCart(itemId) {
      const item = menuItems.find(item => item.id === itemId);
      const btn = document.querySelector(`.add-to-cart-btn[data-id="${itemId}"]`);
      if (item && btn) {
        if (!btn.classList.contains('bg-green-500')) {
          const existingItem = cart.find(cartItem => cartItem.id === itemId);
          if (existingItem) {
            existingItem.quantity += 1;
          } else {
            cart.push({
              id: item.id,
              name: item.name,
              price: item.price,
              image: item.image,
              quantity: 1
            });
          }
          updateCartUI();
        }
        showAddToCartAnimation(itemId);
      }
    }
    function showAddToCartAnimation(itemId) {
      const btn = document.querySelector(`.add-to-cart-btn[data-id="${itemId}"]`);
      if (btn) {
        if (btn.classList.contains('bg-green-500')) {
          btn.innerHTML = '<i class="fa fa-plus mr-1"></i> åŠ å…¥è´­ç‰©è½¦';
          btn.classList.remove('bg-green-500');
          removeFromCart(itemId);
        } else {
          btn.innerHTML = '<i class="fa fa-check mr-1"></i> å·²æ·»åŠ ';
          btn.classList.add('bg-green-500');
        }
      }
    }

    // ä»è´­ç‰©è½¦ç§»é™¤å•†å“
    function removeFromCart(itemId) {
      const index = cart.findIndex(item => item.id === itemId);
      if (index !== -1) {
        cart.splice(index, 1);
        updateCartUI();
      }
    }

    // æ›´æ–°å•†å“æ•°é‡
    function updateQuantity(itemId, newQuantity) {
      if (newQuantity < 1) return;
      const item = cart.find(item => item.id === itemId);
      if (item) {
        item.quantity = newQuantity;
        updateCartUI();
      }
    }

    // æ›´æ–°è´­ç‰©è½¦UI
    function updateCartUI() {
      const cartList = document.getElementById('cart-list');
      const emptyCart = document.getElementById('empty-cart');
      const cartSummary = document.getElementById('cart-summary');
      const cartCount = document.getElementById('cart-count');
      const cartCountFixed = document.getElementById('cart-count-fixed');
      const subtotalElement = document.getElementById('subtotal');
      const totalElement = document.getElementById('total');
      
      // æ›´æ–°è´­ç‰©è½¦æ•°é‡
      const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
      cartCount.textContent = totalItems;
      if (cartCountFixed) {
        cartCountFixed.textContent = totalItems;
      }
      
      // æ˜¾ç¤ºæˆ–éšè—ç©ºè´­ç‰©è½¦æç¤º
      if (cart.length === 0) {
        cartList.classList.add('hidden');
        emptyCart.classList.remove('hidden');
        cartSummary.classList.add('hidden');
        return;
      } else {
        cartList.classList.remove('hidden');
        emptyCart.classList.add('hidden');
        cartSummary.classList.remove('hidden');
      }
      
      // æ›´æ–°è´­ç‰©è½¦å•†å“åˆ—è¡¨
      cartList.innerHTML = '';
      cart.forEach(item => {
        const cartItem = document.createElement('div');
        cartItem.className = 'flex items-center border-b pb-4';
        cartItem.innerHTML = `
          <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-lg mr-4">
          <div class="flex-1">
            <h4 class="font-medium">${item.name}</h4>
            <p class="text-primary">Â¥${item.price.toFixed(2)}</p>
            <div class="flex items-center mt-2">
              <button class="decrease-quantity px-2 py-1 border rounded-l" data-id="${item.id}">-</button>
              <span class="px-3 py-1 border-t border-b">${item.quantity}</span>
              <button class="increase-quantity px-2 py-1 border rounded-r" data-id="${item.id}">+</button>
            </div>
          </div>
          <button class="remove-item ml-2 text-gray-400 hover:text-red-500" data-id="${item.id}">
            <i class="fa fa-trash"></i>
          </button>
        `;
        cartList.appendChild(cartItem);
      });
      
      // æ·»åŠ æ•°é‡è°ƒæ•´æŒ‰é’®äº‹ä»¶ç›‘å¬
      document.querySelectorAll('.decrease-quantity').forEach(btn => {
        btn.addEventListener('click', function() {
          const itemId = this.getAttribute('data-id'); 
          const item = cart.find(item => item.id === itemId);
          if (item && item.quantity > 1) {
            updateQuantity(itemId, item.quantity - 1);
          } else if (item && item.quantity === 1) {
            removeFromCart(itemId);
            const menuBtn = document.querySelector(`.add-to-cart-btn[data-id="${itemId}"]`);
            if (menuBtn && menuBtn.classList.contains('bg-green-500')) {
              menuBtn.innerHTML = '<i class="fa fa-plus mr-1"></i> åŠ å…¥è´­ç‰©è½¦';
              menuBtn.classList.remove('bg-green-500');
            }
          }
        });
      });
      document.querySelectorAll('.increase-quantity').forEach(btn => {
        btn.addEventListener('click', function() {
          const itemId = this.getAttribute('data-id'); 
          const item = cart.find(item => item.id === itemId);
          if (item) {
            updateQuantity(itemId, item.quantity + 1);
          }
        });
      });
      document.querySelectorAll('.remove-item').forEach(btn => {
        btn.addEventListener('click', function() {
          const itemId = this.getAttribute('data-id'); 
          removeFromCart(itemId);
          const menuBtn = document.querySelector(`.add-to-cart-btn[data-id="${itemId}"]`);
          if (menuBtn && menuBtn.classList.contains('bg-green-500')) {
            menuBtn.innerHTML = '<i class="fa fa-plus mr-1"></i> åŠ å…¥è´­ç‰©è½¦';
            menuBtn.classList.remove('bg-green-500');
          }
        });
      });
      
      // è®¡ç®—é‡‘é¢
      const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
      const total = subtotal;
      subtotalElement.textContent = `Â¥${subtotal.toFixed(2)}`;
      totalElement.textContent = `Â¥${total.toFixed(2)}`;
    }

    // æ‰“å¼€è´­ç‰©è½¦
    function openCart() {
      document.getElementById('cart-drawer').classList.add('open');
      document.getElementById('overlay').classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    // å…³é—­è´­ç‰©è½¦
    function closeCart() {
      document.getElementById('cart-drawer').classList.remove('open');
      document.getElementById('overlay').classList.add('hidden');
      document.body.style.overflow = '';
    }

    // è®¢å•ç¡®è®¤å€’è®¡æ—¶
    let countdownInterval;
    let countdownSeconds = 300; // 5åˆ†é’Ÿ

    // å¼€å§‹å€’è®¡æ—¶
    function startCountdown() {
      const timerElement = document.getElementById('countdown-timer');
      const progressElement = document.getElementById('countdown-progress');
      const initialSeconds = 300; // ä½¿ç”¨å›ºå®šçš„åˆå§‹å€¼ï¼ˆ5åˆ†é’Ÿï¼‰
      
      // æ¸…é™¤æ—§çš„å€’è®¡æ—¶å®ä¾‹
      clearInterval(countdownInterval);
      
      // é‡ç½®å€’è®¡æ—¶æ—¶é—´
      countdownSeconds = initialSeconds;
      
      // è·å–å½“å‰è®¢å•æ€»é‡‘é¢
      const totalElement = document.getElementById('total');
      const totalAmountText = totalElement ? totalElement.textContent : 'Â¥0.00';
      const totalAmount = parseFloat(totalAmountText.replace('Â¥', ''));
      
      // æ›´æ–°æ”¶æ¬¾é‡‘é¢æ˜¾ç¤º
      const paymentAmountElement = document.getElementById('payment-amount');
      if (paymentAmountElement) {
        paymentAmountElement.textContent = totalAmountText;
      }
      
      // ç”Ÿæˆæ”¯ä»˜å®æ”¶æ¬¾ç 
      const alipayQrCodeElement = document.getElementById('alipay-qrcode');
      if (alipayQrCodeElement) {
          const baseAlipayLink = 'https://qr.alipay.com/fkx12625ywzianquigkew52';
          const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://qr.alipay.com/fkx12625ywzianquigkew52?amount=${totalAmount}`;
          alipayQrCodeElement.src = qrCodeUrl;
      }
      
      updateCountdownDisplay();
      
      countdownInterval = setInterval(() => {
        countdownSeconds--;
        
        if (countdownSeconds <= 0) {
          clearInterval(countdownInterval);
          document.getElementById('countdown-section').classList.add('hidden'); 
          resetCountdown();
          return;
        }
        
        updateCountdownDisplay(); 
        
        // æ›´æ–°è¿›åº¦æ¡
        const progress = (countdownSeconds / initialSeconds) * 100;
        progressElement.style.width = `${progress}%`;
      }, 1000);
      function updateCountdownDisplay() {
        const minutes = Math.floor(countdownSeconds / 60);
        const seconds = countdownSeconds % 60;
        timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      }
    }

    // é‡ç½®å€’è®¡æ—¶
    function resetCountdown() {
      clearInterval(countdownInterval);
      countdownSeconds = 300; // é‡ç½®ä¸º5åˆ†é’Ÿ
      document.getElementById('countdown-progress').style.width = '100%';
    }
  </script>
  
  <!-- é¡µè„š -->
  <footer class="bg-dark text-white py-8">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <!-- å…³äºæˆ‘ -->
        <div data-aos="fade-up">
          <h3 class="text-lg font-semibold mb-4">å…³äºæˆ‘</h3>
          <p class="text-gray-400 mb-4">ä¸€ä¸ªæŠ€èƒ½æ ‘è¶Šç‚¹è¶Šæ­ªçš„ä¸ªäººåšä¸»ã€‚</p>
          <div class="flex space-x-4">
            <a href="https://github.com/zayck" class="text-gray-400 hover:text-white transition-colors" target="_blank" rel="noopener noreferrer">
              <i class="fa fa-github"></i>
            </a>
            <a href="https://space.bilibili.com/341981702" class="text-gray-400 hover:text-white transition-colors" target="_blank" rel="noopener noreferrer">
              <i class="fa fa-youtube-play"></i>
            </a>
            <a href="https://mp.weixin.qq.com/s/eSMLs8lNVw_dOEamsXIw-Q" class="text-gray-400 hover:text-white transition-colors" target="_blank" rel="noopener noreferrer">
              <i class="fa fa-weixin"></i>
            </a>
            <a href="https://zayck.pages.dev/rss.xml" class="text-gray-400 hover:text-white transition-colors" target="_blank" rel="noopener noreferrer">
              <i class="fa fa-feed"></i>
            </a>
          </div>
        </div>
        
        <!-- å¿«é€Ÿé“¾æ¥ -->
        <div data-aos="fade-up" data-aos-delay="100">
          <h3 class="text-lg font-semibold mb-4">å¿«é€Ÿé“¾æ¥</h3>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">é¦–é¡µ</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">èœå•</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">ä¼˜æƒ æ´»åŠ¨</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">å…³äºæˆ‘ä»¬</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">è”ç³»æˆ‘ä»¬</a></li>
          </ul>
        </div>
        
        <!-- è”ç³»æ–¹å¼ -->
        <div data-aos="fade-up" data-aos-delay="200">
          <h3 class="text-lg font-semibold mb-4">è”ç³»æ–¹å¼</h3>
          <ul class="space-y-2">
            <li class="flex items-start">
              <i class="fa fa-map-marker text-gray-400 mt-1 mr-2"></i>
              <span class="text-gray-400">å¹¿ä¸œä¸œè</span>
            </li>
            <li class="flex items-center">
              <i class="fa fa-phone text-gray-400 mr-2"></i>
              <span class="text-gray-400">400-888-8888</span>
            </li>
            <li class="flex items-center">
              <i class="fa fa-envelope text-gray-400 mr-2"></i>
              <span class="text-gray-400">savaii@163.com</span>
            </li>
          </ul>
        </div>
        
        <!-- è¥ä¸šæ—¶é—´ -->
        <div data-aos="fade-up" data-aos-delay="300">
          <h3 class="text-lg font-semibold mb-4">è¥ä¸šæ—¶é—´</h3>
          <ul class="space-y-2">
            <li class="flex justify-between">
              <span class="text-gray-400">å‘¨ä¸€è‡³å‘¨äº”</span>
              <span class="text-gray-400">10:00 - 22:00</span>
            </li>
            <li class="flex justify-between">
              <span class="text-gray-400">å‘¨å…­è‡³å‘¨æ—¥</span>
              <span class="text-gray-400">09:00 - 23:00</span>
            </li>
            <li class="flex justify-between">
              <span class="text-gray-400">èŠ‚å‡æ—¥</span>
              <span class="text-gray-400">09:00 - 23:00</span>
            </li>
          </ul>
        </div>
      </div>
      
      <div class="border-t border-gray-700 mt-8 pt-6 text-center">
        <p class="text-gray-400">Copyright Â© <a href="https://zayck.pages.dev">Zayck å°‘é˜³</a> 2025 - All right reserved</p>
      </div>
    </div>
  </footer>

</body></html>