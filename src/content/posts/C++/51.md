---
title: 51.extern Cæœ‰ä»€ä¹ˆä½œç”¨
order: 51
description: è¯¦è§£C++ä¸­extern Cçš„ä½œç”¨ã€åŸç†ã€ä½¿ç”¨åœºæ™¯å’Œæœ€ä½³å®è·µ
published: '2026-01-23'
image: /assets/images/cpp-logo.webp
tags:
- C++
- ç¼–è¯‘é“¾æ¥
- æ··åˆç¼–ç¨‹
- extern
- åç§°ä¿®é¥°
category: C++
---
# ğŸ”¬ extern Cæœ‰ä»€ä¹ˆä½œç”¨
## ğŸ“– å†…å®¹æ¦‚è§ˆ

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

## ğŸ”„ åŠŸèƒ½è¯¦è§£

## âš ï¸ âš ï¸ âš ï¸ âš ï¸ âš ï¸ âš ï¸ æ³¨æ„äº‹é¡¹

## ğŸ’¡ å…³é”®è¦ç‚¹

## ğŸ“‹ æ€»ç»“


ğŸ“– **å†…å®¹æ¦‚è§ˆ**

æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»C++ä¸­`extern "C"`çš„ä½œç”¨ã€åŸç†å’Œä½¿ç”¨åœºæ™¯ã€‚é€šè¿‡æ·±å…¥ç†è§£`extern "C"`çš„å·¥ä½œæœºåˆ¶ï¼Œå¸®åŠ©å¼€å‘è€…åœ¨C++å’ŒCè¯­è¨€æ··åˆç¼–ç¨‹æ—¶é¿å…é“¾æ¥é”™è¯¯ï¼Œå®ç°ä¸åŒè¯­è¨€æ¨¡å—ä¹‹é—´çš„æ­£ç¡®è°ƒç”¨ã€‚

ğŸ“š **åŸºæœ¬æ¦‚å¿µ**

### 1.1 ä»€ä¹ˆæ˜¯extern "C"

`extern "C"`æ˜¯C++ä¸­çš„ä¸€ä¸ªé“¾æ¥è§„èŒƒï¼ˆLinkage Specificationï¼‰ï¼Œç”¨äºæŒ‡ç¤ºç¼–è¯‘å™¨æŒ‰ç…§Cè¯­è¨€çš„è§„åˆ™æ¥ç¼–è¯‘å’Œé“¾æ¥ç‰¹å®šçš„ä»£ç å—æˆ–å‡½æ•°ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯**å®ç°C++ä»£ç ä¸Cè¯­è¨€ä»£ç çš„äº’æ“ä½œ**ã€‚

### 1.2 externå…³é”®å­—çš„åŸºæœ¬ä½œç”¨

åœ¨Cå’ŒC++ä¸­ï¼Œ`extern`å…³é”®å­—éƒ½ç”¨äº**å£°æ˜å¤–éƒ¨ç¬¦å·**ï¼ˆå˜é‡æˆ–å‡½æ•°ï¼‰ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨ï¼š

- è¯¥ç¬¦å·çš„å®šä¹‰åœ¨å…¶ä»–æ–‡ä»¶ä¸­
- ç¼–è¯‘å™¨åœ¨é“¾æ¥æ—¶éœ€è¦ä»å…¶ä»–æ¨¡å—æŸ¥æ‰¾è¯¥ç¬¦å·çš„å®šä¹‰

ğŸ¯ **extern "C"çš„æ ¸å¿ƒä½œç”¨**

### 2.1 è§£å†³åç§°ä¿®é¥°é—®é¢˜

`extern "C"`çš„æ ¸å¿ƒä½œç”¨æ˜¯**é¿å…C++çš„åç§°ä¿®é¥°ï¼ˆName Manglingï¼‰**ï¼Œè¿™æ˜¯C++æ”¯æŒå‡½æ•°é‡è½½çš„å…³é”®æœºåˆ¶ã€‚

#### 2.1.1 ä»€ä¹ˆæ˜¯åç§°ä¿®é¥°

**åç§°ä¿®é¥°**æ˜¯ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œå°†å‡½æ•°åã€å‚æ•°ç±»å‹ç­‰ä¿¡æ¯ç¼–ç åˆ°æœ€ç»ˆçš„ç¬¦å·åä¸­çš„è¿‡ç¨‹ã€‚

- **Cè¯­è¨€**ï¼šç¬¦å·ååŸºæœ¬ä¿æŒä¸å˜ï¼Œä¾‹å¦‚å‡½æ•°`int add(int a, int b)`ä¼šè¢«ç¼–è¯‘ä¸º`_add`ï¼ˆä¸åŒç¼–è¯‘å™¨å¯èƒ½æœ‰ç»†å¾®å·®å¼‚ï¼‰
- **C++è¯­è¨€**ï¼šç¬¦å·åä¼šåŒ…å«å‡½æ•°åã€å‚æ•°ç±»å‹ã€è¿”å›ç±»å‹ç­‰ä¿¡æ¯ï¼Œä¾‹å¦‚`int add(int a, int b)`å¯èƒ½ä¼šè¢«ç¼–è¯‘ä¸º`_add_int_int`æˆ–æ›´å¤æ‚çš„å½¢å¼

#### 2.1.2 åç§°ä¿®é¥°çš„å½±å“

C++çš„åç§°ä¿®é¥°æœºåˆ¶å¯¼è‡´ï¼š

1. C++ç¼–è¯‘å™¨ç¼–è¯‘çš„å‡½æ•°æ— æ³•è¢«Cç¼–è¯‘å™¨ç›´æ¥è°ƒç”¨
2. Cç¼–è¯‘å™¨ç¼–è¯‘çš„å‡½æ•°æ— æ³•è¢«C++ç¼–è¯‘å™¨ç›´æ¥è°ƒç”¨
3. é“¾æ¥å™¨æ— æ³•åŒ¹é…ä¸åŒè¯­è¨€ç¼–è¯‘çš„ç¬¦å·

### 2.2 å®ç°C++ä¸Cçš„äº’æ“ä½œ

`extern "C"`é€šè¿‡ç¦ç”¨åç§°ä¿®é¥°ï¼Œä½¿å¾—C++ä»£ç å¯ä»¥ï¼š

- è°ƒç”¨Cè¯­è¨€ç¼–å†™çš„å‡½æ•°å’Œè®¿é—®Cè¯­è¨€çš„å…¨å±€å˜é‡
- è¢«Cè¯­è¨€ç¼–å†™çš„ä»£ç è°ƒç”¨

ğŸ’» **extern "C"çš„ä½¿ç”¨è¯­æ³•**

### 3.1 ä¿®é¥°å•ä¸ªå‡½æ•°

```cpp
// å£°æ˜Cè¯­è¨€å‡½æ•°
extern "C" int add(int a, int b);

// å®šä¹‰Cè¯­è¨€é£æ ¼çš„å‡½æ•°
extern "C" int subtract(int a, int b) {
    return a - b;
}
```

### 3.2 ä¿®é¥°ä»£ç å—

```cpp
// ä¿®é¥°å¤šä¸ªå‡½æ•°
extern "C" {
    int multiply(int a, int b);
    int divide(int a, int b);
    void print_result(int result);
}
```

### 3.3 åœ¨å¤´æ–‡ä»¶ä¸­ä½¿ç”¨

åœ¨æ··åˆç¼–ç¨‹ä¸­ï¼Œå¤´æ–‡ä»¶éœ€è¦åŒæ—¶æ”¯æŒCå’ŒC++ç¼–è¯‘ï¼Œé€šå¸¸ä½¿ç”¨æ¡ä»¶ç¼–è¯‘ï¼š

```cpp
// header.h
#ifdef __cplusplus
extern "C" {
#endif

// Cå‡½æ•°å£°æ˜
int add(int a, int b);
void print_message(const char* msg);

#ifdef __cplusplus
}
#endif
```

ğŸ” **extern "C"çš„å·¥ä½œåŸç†**

### 4.1 ç¼–è¯‘é˜¶æ®µ

å½“ç¼–è¯‘å™¨é‡åˆ°`extern "C"`æ—¶ï¼Œä¼šï¼š

1. å¯¹äºå£°æ˜ï¼šè®°å½•è¯¥ç¬¦å·éœ€è¦æŒ‰ç…§Cè¯­è¨€è§„åˆ™é“¾æ¥
2. å¯¹äºå®šä¹‰ï¼šç”ŸæˆCè¯­è¨€é£æ ¼çš„ç¬¦å·åï¼Œä¸è¿›è¡Œåç§°ä¿®é¥°

### 4.2 é“¾æ¥é˜¶æ®µ

é“¾æ¥å™¨åœ¨é“¾æ¥æ—¶ï¼š

1. å¯¹äºC++ä»£ç ä¸­å£°æ˜ä¸º`extern "C"`çš„ç¬¦å·ï¼Œä¼šæŸ¥æ‰¾Cè¯­è¨€é£æ ¼çš„ç¬¦å·å
2. å¯¹äºCä»£ç ä¸­è°ƒç”¨çš„C++å‡½æ•°ï¼Œè¦æ±‚è¯¥å‡½æ•°åœ¨C++ä¸­å£°æ˜ä¸º`extern "C"`

ğŸ› ï¸ **å…·ä½“ä½¿ç”¨åœºæ™¯**

### 5.1 åœºæ™¯1ï¼šC++è°ƒç”¨Cä»£ç 

**ç¤ºä¾‹ï¼š**

```c
// c_library.c (Cè¯­è¨€å®ç°)
#include "c_library.h"

int add(int a, int b) {
    return a + b;
}

void print_message(const char* msg) {
    printf("Message: %s\n", msg);
}
```

```c
// c_library.h (Cè¯­è¨€å¤´æ–‡ä»¶)
#ifdef __cplusplus
extern "C" {
#endif

int add(int a, int b);
void print_message(const char* msg);

#ifdef __cplusplus
}
#endif
```

```cpp
// cpp_program.cpp (C++è°ƒç”¨Cä»£ç )
#include "c_library.h" // åŒ…å«Cè¯­è¨€å¤´æ–‡ä»¶
#include <iostream>

int main() {
    // è°ƒç”¨Cè¯­è¨€å‡½æ•°
    int result = add(10, 20);
    std::cout << "10 + 20 = " << result << std::endl;
    
    // è°ƒç”¨Cè¯­è¨€å‡½æ•°
    print_message("Hello from C++");
    
    return 0;
}
```

### 5.2 åœºæ™¯2ï¼šCä»£ç è°ƒç”¨C++ä»£ç 

**ç¤ºä¾‹ï¼š**

```cpp
// cpp_library.cpp (C++å®ç°)
#include "cpp_library.h"
#include <iostream>

// ä½¿ç”¨extern "C"å£°æ˜ï¼Œè®©Cä»£ç å¯ä»¥è°ƒç”¨
extern "C" void cpp_function(const char* msg) {
    std::cout << "C++ function called with: " << msg << std::endl;
}

// C++å†…éƒ¨ä½¿ç”¨çš„å‡½æ•°ï¼ˆä¸æš´éœ²ç»™Cï¼‰
void internal_cpp_function() {
    // ä»…C++å†…éƒ¨ä½¿ç”¨
}
```

```c
// cpp_library.h (å¤´æ–‡ä»¶ï¼ŒåŒæ—¶æ”¯æŒCå’ŒC++)
#ifdef __cplusplus
extern "C" {
#endif

// å£°æ˜å¯ä»¥è¢«Cè°ƒç”¨çš„C++å‡½æ•°
void cpp_function(const char* msg);

#ifdef __cplusplus
}
#endif
```

```c
// c_program.c (Cè°ƒç”¨C++ä»£ç )
#include "cpp_library.h" // åŒ…å«å£°æ˜äº†extern "C"çš„å¤´æ–‡ä»¶

int main() {
    // è°ƒç”¨C++å‡½æ•°
    cpp_function("Hello from C");
    
    return 0;
}
```

### 5.3 åœºæ™¯3ï¼šåœ¨C++ä¸­ä½¿ç”¨Cåº“

è®¸å¤šç³»ç»Ÿåº“å’Œç¬¬ä¸‰æ–¹åº“éƒ½æ˜¯ç”¨Cè¯­è¨€ç¼–å†™çš„ï¼Œä¾‹å¦‚ï¼š

- æ ‡å‡†Cåº“ï¼ˆå¦‚`stdio.h`ã€`stdlib.h`ï¼‰
- ç³»ç»ŸAPIï¼ˆå¦‚Windows APIã€POSIX APIï¼‰
- ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚OpenSSLã€SQLiteï¼‰

åœ¨C++ä¸­ä½¿ç”¨è¿™äº›åº“æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç†`extern "C"`ï¼Œå› ä¸ºè¿™äº›åº“çš„å¤´æ–‡ä»¶å·²ç»åŒ…å«äº†é€‚å½“çš„`extern "C"`å£°æ˜ã€‚

âš ï¸ **extern "C"çš„æ³¨æ„äº‹é¡¹**

### 6.1 å‡½æ•°é‡è½½ä¸extern "C"

**`extern "C"`ä¸å‡½æ•°é‡è½½ä¸èƒ½åŒæ—¶ä½¿ç”¨**ï¼Œå› ä¸ºï¼š

- å‡½æ•°é‡è½½ä¾èµ–äºåç§°ä¿®é¥°
- `extern "C"`ç¦ç”¨äº†åç§°ä¿®é¥°
- å› æ­¤ï¼ŒåŒä¸€ä¸ªå‡½æ•°ååªèƒ½æœ‰ä¸€ä¸ª`extern "C"`ç‰ˆæœ¬

```cpp
// é”™è¯¯ï¼šä¸èƒ½å¯¹é‡è½½å‡½æ•°ä½¿ç”¨extern "C"
extern "C" int add(int a, int b);
extern "C" double add(double a, double b); // ç¼–è¯‘é”™è¯¯

// æ­£ç¡®ï¼šå¯ä»¥æœ‰ä¸€ä¸ªextern "C"ç‰ˆæœ¬å’Œä¸€ä¸ªC++ç‰ˆæœ¬
extern "C" int add(int a, int b);
double add(double a, double b); // C++ç‰ˆæœ¬ï¼Œä¼šè¢«åç§°ä¿®é¥°
```

### 6.2 ç±»æˆå‘˜å‡½æ•°ä¸èƒ½ä½¿ç”¨extern "C"

**ç±»æˆå‘˜å‡½æ•°ä¸èƒ½ç›´æ¥ä½¿ç”¨`extern "C"`**ï¼Œå› ä¸ºï¼š

- ç±»æˆå‘˜å‡½æ•°éšå«äº†`this`æŒ‡é’ˆå‚æ•°
- Cè¯­è¨€ä¸æ”¯æŒ`this`æŒ‡é’ˆ
- Cè¯­è¨€ä¸æ”¯æŒç±»çš„æ¦‚å¿µ

å¦‚æœéœ€è¦è®©Cä»£ç è°ƒç”¨C++ç±»çš„æˆå‘˜å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨**åŒ…è£…å‡½æ•°**ï¼š

```cpp
// C++ç±»
class Calculator {
public:
    int add(int a, int b) {
        return a + b;
    }
};

// å…¨å±€å®ä¾‹
Calculator calc;

// åŒ…è£…å‡½æ•°ï¼Œä¾›Cè¯­è¨€è°ƒç”¨
extern "C" int calculator_add(int a, int b) {
    return calc.add(a, b);
}
```

### 6.3 å˜é‡çš„extern "C"

`extern "C"`ä¹Ÿå¯ä»¥ç”¨äºå˜é‡å£°æ˜ï¼š

```cpp
// C++æ–‡ä»¶ä¸­å£°æ˜Cè¯­è¨€å˜é‡
extern "C" int global_count;

// Cæ–‡ä»¶ä¸­å®šä¹‰å˜é‡
int global_count = 0;
```

### 6.4 å¤´æ–‡ä»¶çš„æ­£ç¡®ä½¿ç”¨

- å¯¹äºåŒæ—¶è¢«Cå’ŒC++åŒ…å«çš„å¤´æ–‡ä»¶ï¼Œå¿…é¡»ä½¿ç”¨æ¡ä»¶ç¼–è¯‘åŒ…è£¹`extern "C"`
- å¦åˆ™ï¼ŒCç¼–è¯‘å™¨ä¼šå°†`extern "C"`è§†ä¸ºè¯­æ³•é”™è¯¯

âš–ï¸ **externä¸extern "C"çš„åŒºåˆ«**

| ç‰¹æ€§ | extern | extern "C" |
|------|--------|-------------|
| **é€‚ç”¨è¯­è¨€** | Cå’ŒC++ | ä¸»è¦ç”¨äºC++ |
| **ä½œç”¨** | å£°æ˜å¤–éƒ¨ç¬¦å· | å£°æ˜å¤–éƒ¨ç¬¦å·å¹¶æŒ‡ç¤ºCè¯­è¨€é“¾æ¥è§„åˆ™ |
| **åç§°ä¿®é¥°** | ä¸å½±å“åç§°ä¿®é¥° | ç¦ç”¨åç§°ä¿®é¥° |
| **å‡½æ•°é‡è½½** | æ”¯æŒ | ä¸æ”¯æŒ |
| **äº’æ“ä½œæ€§** | ä»…åŒè¯­è¨€ | æ”¯æŒè·¨è¯­è¨€ |

ğŸŒŸ **æœ€ä½³å®è·µ**

### 8.1 1. å§‹ç»ˆåœ¨å¤´æ–‡ä»¶ä¸­ä½¿ç”¨extern "C"

å°†`extern "C"`å£°æ˜æ”¾åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯æºæ–‡ä»¶ä¸­ï¼Œç¡®ä¿æ‰€æœ‰åŒ…å«è¯¥å¤´æ–‡ä»¶çš„æºæ–‡ä»¶éƒ½èƒ½æ­£ç¡®å¤„ç†é“¾æ¥è§„åˆ™ã€‚

### 8.2 2. ä½¿ç”¨æ¡ä»¶ç¼–è¯‘

åœ¨å¤´æ–‡ä»¶ä¸­ä½¿ç”¨`#ifdef __cplusplus`æ¡ä»¶ç¼–è¯‘ï¼Œç¡®ä¿å¤´æ–‡ä»¶åŒæ—¶å…¼å®¹Cå’ŒC++ç¼–è¯‘å™¨ã€‚

### 8.3 3. é¿å…è¿‡åº¦ä½¿ç”¨extern "C"

åªå¯¹éœ€è¦ä¸Cè¯­è¨€äº¤äº’çš„å‡½æ•°ä½¿ç”¨`extern "C"`ï¼ŒC++å†…éƒ¨å‡½æ•°ä¸éœ€è¦ä½¿ç”¨ã€‚

### 8.4 4. æ³¨æ„å‡½æ•°ç­¾ååŒ¹é…

ç¡®ä¿Cå’ŒC++ä¹‹é—´è°ƒç”¨çš„å‡½æ•°ç­¾åå®Œå…¨åŒ¹é…ï¼ŒåŒ…æ‹¬ï¼š
- å‡½æ•°å
- å‚æ•°ç±»å‹å’Œæ•°é‡
- è¿”å›ç±»å‹
- è°ƒç”¨çº¦å®šï¼ˆå¦‚`__cdecl`ã€`__stdcall`ç­‰ï¼‰

### 8.5 5. é¿å…åœ¨extern "C"å—ä¸­å£°æ˜C++ç‰¹æœ‰çš„ç±»å‹

`extern "C"`å—ä¸­åº”åªåŒ…å«Cè¯­è¨€å…¼å®¹çš„ç±»å‹ï¼Œé¿å…ä½¿ç”¨C++ç‰¹æœ‰çš„ç±»å‹å¦‚`std::string`ã€`std::vector`ç­‰ã€‚

ğŸ“‹ **æ€»ç»“**

### 9.1 extern "C"çš„æ ¸å¿ƒè¦ç‚¹

1. **è§£å†³åç§°ä¿®é¥°é—®é¢˜**ï¼šç¦ç”¨C++çš„åç§°ä¿®é¥°ï¼Œç”ŸæˆCè¯­è¨€é£æ ¼çš„ç¬¦å·å
2. **å®ç°è·¨è¯­è¨€è°ƒç”¨**ï¼šå…è®¸C++ä»£ç è°ƒç”¨Cä»£ç ï¼Œåä¹‹äº¦ç„¶
3. **é“¾æ¥è§„èŒƒ**ï¼šæ˜¯ä¸€ç§é“¾æ¥è§„èŒƒï¼Œå½±å“ç¼–è¯‘å™¨ç”Ÿæˆçš„ç¬¦å·å
4. **ä¸å‡½æ•°é‡è½½ä¸å…¼å®¹**ï¼šå› ä¸ºå®ƒç¦ç”¨äº†åç§°ä¿®é¥°
5. **ä¸»è¦ç”¨äºæ··åˆç¼–ç¨‹**ï¼šåœ¨C++é¡¹ç›®ä¸­ä½¿ç”¨Cåº“æˆ–ä¸ºCé¡¹ç›®æä¾›C++åº“æ—¶ä½¿ç”¨

### 9.2 ä½•æ—¶ä½¿ç”¨extern "C"

- å½“C++ä»£ç éœ€è¦è°ƒç”¨Cè¯­è¨€ç¼–å†™çš„å‡½æ•°æ—¶
- å½“éœ€è¦è®©Cè¯­è¨€ä»£ç è°ƒç”¨C++å‡½æ•°æ—¶
- å½“ç¼–å†™éœ€è¦è¢«Cå’ŒC++å…±åŒä½¿ç”¨çš„åº“æ—¶
- å½“ä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ç³»ç»Ÿåº“æˆ–ç¬¬ä¸‰æ–¹åº“æ—¶

### 9.3 å…³é”®ç»“è®º

`extern "C"`æ˜¯C++ä¸­å®ç°è·¨è¯­è¨€äº’æ“ä½œçš„é‡è¦æœºåˆ¶ï¼Œé€šè¿‡ç†è§£å…¶å·¥ä½œåŸç†å’Œæ­£ç¡®ä½¿ç”¨ï¼Œå¯ä»¥é¿å…é“¾æ¥é”™è¯¯ï¼Œå®ç°Cå’ŒC++ä»£ç ä¹‹é—´çš„æ— ç¼è°ƒç”¨ã€‚åœ¨æ··åˆç¼–ç¨‹åœºæ™¯ä¸­ï¼Œæ­£ç¡®ä½¿ç”¨`extern "C"`æ˜¯ç¡®ä¿ä»£ç å¯ç§»æ¤æ€§å’Œæ­£ç¡®æ€§çš„å…³é”®ã€‚

é€šè¿‡éµå¾ªæœ€ä½³å®è·µï¼Œå¼€å‘è€…å¯ä»¥åœ¨C++é¡¹ç›®ä¸­å……åˆ†åˆ©ç”¨Cè¯­è¨€åº“çš„èµ„æºï¼ŒåŒæ—¶ä¿æŒä»£ç çš„æ¸…æ™°æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚