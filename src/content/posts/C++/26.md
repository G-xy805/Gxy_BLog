---
title: 26.unique_ptrå’Œshared_ptråŒºåˆ«
order: 26
description: è¯¦è§£C++æ™ºèƒ½æŒ‡é’ˆunique_ptrå’Œshared_ptrçš„åŒºåˆ«ã€ä½¿ç”¨åœºæ™¯å’Œæœ€ä½³å®è·µ
published: '2026-01-23'
image: /assets/images/cpp-logo.webp
tags:
- C++
- æ™ºèƒ½æŒ‡é’ˆ
- å†…å­˜ç®¡ç†
- å¼•ç”¨è®¡æ•°
category: C++
---
# ğŸ“š unique_ptrå’Œshared_ptråŒºåˆ«

## ğŸ“– å†…å®¹æ¦‚è§ˆ
unique_ptrå’Œshared_ptræ˜¯C++11å¼•å…¥çš„ä¸¤ç§æ™ºèƒ½æŒ‡é’ˆï¼Œå®ƒä»¬éƒ½ç”¨äºè‡ªåŠ¨ç®¡ç†åŠ¨æ€å†…å­˜ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚ä½†å®ƒä»¬åœ¨æ‰€æœ‰æƒç®¡ç†ã€å¼•ç”¨è®¡æ•°ã€ä½¿ç”¨åœºæ™¯ç­‰æ–¹é¢å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚æœ¬æ–‡å°†è¯¦ç»†è§£æè¿™ä¸¤ç§æ™ºèƒ½æŒ‡é’ˆçš„æ ¸å¿ƒåŒºåˆ«ã€ä½¿ç”¨æ–¹æ³•ã€æŠ€æœ¯åŸç†å’Œæœ€ä½³å®è·µã€‚

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### 1. unique_ptræ ¸å¿ƒç‰¹æ€§

unique_ptræ˜¯ä¸€ç§**ç‹¬å æ‰€æœ‰æƒ**çš„æ™ºèƒ½æŒ‡é’ˆï¼š
- **ç‹¬å æ€§**ï¼šä¸€ä¸ªå¯¹è±¡åªèƒ½è¢«ä¸€ä¸ªunique_ptrç®¡ç†
- **æ— å¼•ç”¨è®¡æ•°**ï¼šä¸ç»´æŠ¤å¼•ç”¨è®¡æ•°ï¼Œæ€§èƒ½æ›´é«˜
- **ç§»åŠ¨è¯­ä¹‰**ï¼šæ”¯æŒæ‰€æœ‰æƒè½¬ç§»ï¼Œä¸æ”¯æŒæ‹·è´
- **è‡ªåŠ¨é‡Šæ”¾**ï¼šç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨è°ƒç”¨delete
- **RAIIæœºåˆ¶**ï¼šèµ„æºè·å–å³åˆå§‹åŒ–

### 2. shared_ptræ ¸å¿ƒç‰¹æ€§

shared_ptræ˜¯ä¸€ç§**å…±äº«æ‰€æœ‰æƒ**çš„æ™ºèƒ½æŒ‡é’ˆï¼š
- **å…±äº«æ€§**ï¼šä¸€ä¸ªå¯¹è±¡å¯ä»¥è¢«å¤šä¸ªshared_ptrç®¡ç†
- **å¼•ç”¨è®¡æ•°**ï¼šç»´æŠ¤å¼•ç”¨è®¡æ•°ï¼Œå½“è®¡æ•°ä¸º0æ—¶é‡Šæ”¾èµ„æº
- **æ‹·è´è¯­ä¹‰**ï¼šæ”¯æŒæ‹·è´å’Œèµ‹å€¼
- **çº¿ç¨‹å®‰å…¨**ï¼šå¼•ç”¨è®¡æ•°çš„å¢å‡æ˜¯çº¿ç¨‹å®‰å…¨çš„
- **è‡ªåŠ¨é‡Šæ”¾**ï¼šå½“æœ€åä¸€ä¸ªshared_ptrç¦»å¼€ä½œç”¨åŸŸæ—¶é‡Šæ”¾èµ„æº

### 3. å¼•ç”¨è®¡æ•°æœºåˆ¶

shared_ptrçš„å¼•ç”¨è®¡æ•°æœºåˆ¶ï¼š
- **å¢åŠ å¼•ç”¨è®¡æ•°**ï¼šæ‹·è´shared_ptrã€èµ‹å€¼shared_ptr
- **å‡å°‘å¼•ç”¨è®¡æ•°**ï¼šshared_ptrç¦»å¼€ä½œç”¨åŸŸã€è°ƒç”¨reset()ã€èµ‹å€¼æ–°å€¼
- **é‡Šæ”¾èµ„æº**ï¼šå½“å¼•ç”¨è®¡æ•°å‡å°‘åˆ°0æ—¶ï¼Œè°ƒç”¨deleteé‡Šæ”¾èµ„æº

## ğŸ’» ä»£ç ç¤ºä¾‹

### 1. åŸºæœ¬ä½¿ç”¨å¯¹æ¯”

```cpp
#include <iostream>
#include <memory>
#include <string>
using namespace std;

void testBasicUsage() {
    cout << "\n=== åŸºæœ¬ä½¿ç”¨å¯¹æ¯” ===" << endl;
    
    // shared_ptrçš„åŸºæœ¬ä½¿ç”¨
    {   
        shared_ptr<string> sp1 = make_shared<string>("shared_ptr test");
        shared_ptr<string> sp2 = sp1;  // æ‹·è´ï¼Œå¼•ç”¨è®¡æ•°+1
        shared_ptr<string> sp3(sp1);    // æ‹·è´æ„é€ ï¼Œå¼•ç”¨è®¡æ•°+1
        
        cout << "sp1: " << *sp1 << endl;
        cout << "sp2: " << *sp2 << endl;
        cout << "sp3: " << *sp3 << endl;
        cout << "shared_ptrå¼•ç”¨è®¡æ•°: " << sp1.use_count() << endl;  // è¾“å‡ºï¼š3
    }
    
    // unique_ptrçš„åŸºæœ¬ä½¿ç”¨
    {   
        unique_ptr<string> up1 = make_unique<string>("unique_ptr test");
        // unique_ptr<string> up2 = up1;  // é”™è¯¯ï¼šä¸æ”¯æŒæ‹·è´
        unique_ptr<string> up2 = move(up1);  // æ­£ç¡®ï¼šæ”¯æŒç§»åŠ¨è¯­ä¹‰
        
        cout << "up2: " << *up2 << endl;
        // cout << "up1: " << *up1 << endl;  // é”™è¯¯ï¼šup1å·²é‡Šæ”¾æ‰€æœ‰æƒ
    }
}

int main() {
    testBasicUsage();
    return 0;
}
```

### 2. æ‰€æœ‰æƒè½¬ç§»

```cpp
#include <iostream>
#include <memory>
using namespace std;

class Test {
private:
    int id_;
public:
    Test(int id) : id_(id) {
        cout << "ğŸ—ï¸ Testæ„é€ ï¼šid=" << id_ << endl;
    }
    
    ~Test() {
        cout << "ğŸ’¥ Testææ„ï¼šid=" << id_ << endl;
    }
    
    void show() {
        cout << "ğŸ” Test::show() called, id=" << id_ << endl;
    }
};

void testOwnershipTransfer() {
    cout << "\n=== æ‰€æœ‰æƒè½¬ç§» ===" << endl;
    
    // unique_ptrçš„æ‰€æœ‰æƒè½¬ç§»
    {   
        unique_ptr<Test> up1(new Test(1));
        cout << "up1æ‹¥æœ‰æ‰€æœ‰æƒ" << endl;
        
        // ä½¿ç”¨release()è½¬ç§»æ‰€æœ‰æƒ
        Test* raw_ptr = up1.release();
        cout << "up1é‡Šæ”¾æ‰€æœ‰æƒï¼Œraw_ptrç®¡ç†" << endl;
        
        // ä½¿ç”¨reset()è½¬ç§»æ‰€æœ‰æƒ
        unique_ptr<Test> up2;
        up2.reset(raw_ptr);
        cout << "up2è·å¾—æ‰€æœ‰æƒ" << endl;
        
        // ä½¿ç”¨ç§»åŠ¨è¯­ä¹‰è½¬ç§»æ‰€æœ‰æƒ
        unique_ptr<Test> up3 = move(up2);
        cout << "up3è·å¾—æ‰€æœ‰æƒ" << endl;
    }
    
    // shared_ptrçš„æ‰€æœ‰æƒå…±äº«
    {   
        shared_ptr<Test> sp1 = make_shared<Test>(2);
        cout << "sp1å¼•ç”¨è®¡æ•°: " << sp1.use_count() << endl;
        
        {   
            shared_ptr<Test> sp2 = sp1;
            cout << "sp2å¼•ç”¨è®¡æ•°: " << sp2.use_count() << endl;
            
            {   
                shared_ptr<Test> sp3(sp1);
                cout << "sp3å¼•ç”¨è®¡æ•°: " << sp3.use_count() << endl;
            }   // sp3ç¦»å¼€ä½œç”¨åŸŸï¼Œå¼•ç”¨è®¡æ•°-1
            cout << "sp2å¼•ç”¨è®¡æ•°: " << sp2.use_count() << endl;
        }   // sp2ç¦»å¼€ä½œç”¨åŸŸï¼Œå¼•ç”¨è®¡æ•°-1
        cout << "sp1å¼•ç”¨è®¡æ•°: " << sp1.use_count() << endl;
    }   // sp1ç¦»å¼€ä½œç”¨åŸŸï¼Œå¼•ç”¨è®¡æ•°-1ï¼Œå˜ä¸º0ï¼Œé‡Šæ”¾èµ„æº
}

int main() {
    testOwnershipTransfer();
    return 0;
}
```

### 3. å·¥å‚æ¨¡å¼ç¤ºä¾‹

```cpp
#include <iostream>
#include <memory>
#include <string>
using namespace std;

class Product {
private:
    string name_;
public:
    Product(const string& name) : name_(name) {
        cout << "ğŸ—ï¸ Productæ„é€ ï¼š" << name_ << endl;
    }
    
    virtual ~Product() {
        cout << "ğŸ’¥ Productææ„ï¼š" << name_ << endl;
    }
    
    virtual void use() = 0;
};

class ConcreteProductA : public Product {
public:
    ConcreteProductA() : Product("ConcreteProductA") {}
    
    void use() override {
        cout << "ğŸ”§ ConcreteProductA::use()" << endl;
    }
};

class ConcreteProductB : public Product {
public:
    ConcreteProductB() : Product("ConcreteProductB") {}
    
    void use() override {
        cout << "ğŸ”§ ConcreteProductB::use()" << endl;
    }
};

// ä½¿ç”¨unique_ptrçš„å·¥å‚æ¨¡å¼
unique_ptr<Product> createProductUnique(const string& type) {
    if (type == "A") {
        return make_unique<ConcreteProductA>();
    } else if (type == "B") {
        return make_unique<ConcreteProductB>();
    }
    return nullptr;
}

// ä½¿ç”¨shared_ptrçš„å·¥å‚æ¨¡å¼
shared_ptr<Product> createProductShared(const string& type) {
    if (type == "A") {
        return make_shared<ConcreteProductA>();
    } else if (type == "B") {
        return make_shared<ConcreteProductB>();
    }
    return nullptr;
}

void testFactoryPattern() {
    cout << "\n=== å·¥å‚æ¨¡å¼ç¤ºä¾‹ ===" << endl;
    
    // ä½¿ç”¨unique_ptrçš„å·¥å‚
    {
        auto product1 = createProductUnique("A");
        if (product1) {
            product1->use();
        }
        
        auto product2 = createProductUnique("B");
        if (product2) {
            product2->use();
        }
    }
    
    // ä½¿ç”¨shared_ptrçš„å·¥å‚
    {
        auto product1 = createProductShared("A");
        auto product2 = product1;  // å…±äº«æ‰€æœ‰æƒ
        if (product1) {
            product1->use();
        }
        if (product2) {
            product2->use();
        }
        cout << "shared_ptrå¼•ç”¨è®¡æ•°: " << product1.use_count() << endl;
    }
}

int main() {
    testFactoryPattern();
    return 0;
}
```

## ğŸ” è¯¦ç»†å¯¹æ¯”

### 1. æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”

| ç‰¹æ€§ | unique_ptr | shared_ptr |
|------|------------|------------|
| **æ‰€æœ‰æƒ** | ç‹¬å æ‰€æœ‰æƒ | å…±äº«æ‰€æœ‰æƒ |
| **å¼•ç”¨è®¡æ•°** | æ—  | æœ‰ |
| **æ€§èƒ½** | æ›´é«˜ï¼ˆæ— å¼•ç”¨è®¡æ•°å¼€é”€ï¼‰ | è¾ƒä½ï¼ˆå¼•ç”¨è®¡æ•°å¢å‡å¼€é”€ï¼‰ |
| **æ‹·è´æ“ä½œ** | ç¦æ­¢æ‹·è´ï¼Œæ”¯æŒç§»åŠ¨ | æ”¯æŒæ‹·è´å’Œèµ‹å€¼ |
| **çº¿ç¨‹å®‰å…¨** | ä¸ä¿è¯çº¿ç¨‹å®‰å…¨ | å¼•ç”¨è®¡æ•°å¢å‡æ˜¯çº¿ç¨‹å®‰å…¨çš„ |
| **å†…å­˜å¼€é”€** | è¾ƒå°ï¼ˆä»…å­˜å‚¨æŒ‡é’ˆï¼‰ | è¾ƒå¤§ï¼ˆå­˜å‚¨æŒ‡é’ˆ+å¼•ç”¨è®¡æ•°æŒ‡é’ˆï¼‰ |
| **APIå¤æ‚åº¦** | ç®€å• | å¤æ‚ï¼ˆæ”¯æŒæ›´å¤šæ“ä½œï¼‰ |
| **å¾ªç¯å¼•ç”¨** | ä¸ä¼šäº§ç”Ÿ | å¯èƒ½äº§ç”Ÿï¼Œéœ€è¦weak_ptrè§£å†³ |
| **æ•°ç»„æ”¯æŒ** | åŸç”Ÿæ”¯æŒï¼ˆunique_ptr<T[]>ï¼‰ | éœ€è¦è‡ªå®šä¹‰åˆ é™¤å™¨ |

### 2. æ“ä½œå¯¹æ¯”

| æ“ä½œ | unique_ptr | shared_ptr |
|------|------------|------------|
| æ„é€ å‡½æ•° | æ”¯æŒé»˜è®¤æ„é€ ã€å¸¦å‚æ„é€ ã€ç§»åŠ¨æ„é€  | æ”¯æŒé»˜è®¤æ„é€ ã€å¸¦å‚æ„é€ ã€æ‹·è´æ„é€ ã€ç§»åŠ¨æ„é€  |
| æ‹·è´èµ‹å€¼ | ç¦æ­¢ | æ”¯æŒ |
| ç§»åŠ¨èµ‹å€¼ | æ”¯æŒ | æ”¯æŒ |
| reset() | æ”¯æŒ | æ”¯æŒ |
| release() | æ”¯æŒï¼ˆé‡Šæ”¾æ‰€æœ‰æƒï¼‰ | ä¸æ”¯æŒ |
| swap() | æ”¯æŒ | æ”¯æŒ |
| get() | æ”¯æŒï¼ˆè·å–åŸå§‹æŒ‡é’ˆï¼‰ | æ”¯æŒï¼ˆè·å–åŸå§‹æŒ‡é’ˆï¼‰ |
| use_count() | ä¸æ”¯æŒ | æ”¯æŒï¼ˆè·å–å¼•ç”¨è®¡æ•°ï¼‰ |
| unique() | ä¸æ”¯æŒ | æ”¯æŒï¼ˆæ£€æŸ¥æ˜¯å¦ç‹¬å ï¼‰ |
| operator bool() | æ”¯æŒï¼ˆæ£€æŸ¥æ˜¯å¦ä¸ºç©ºï¼‰ | æ”¯æŒï¼ˆæ£€æŸ¥æ˜¯å¦ä¸ºç©ºï¼‰ |
| operator-> | æ”¯æŒ | æ”¯æŒ |
| operator* | æ”¯æŒ | æ”¯æŒ |

### 3. é€‚ç”¨åœºæ™¯å¯¹æ¯”

| åœºæ™¯ | æ¨èä½¿ç”¨ | ä¸æ¨èä½¿ç”¨ |
|------|----------|------------|
| **ç‹¬å èµ„æº** | unique_ptr | shared_ptr |
| **å…±äº«èµ„æº** | - | shared_ptr |
| **æ€§èƒ½æ•æ„Ÿåœºæ™¯** | unique_ptr | shared_ptr |
| **å®¹å™¨å…ƒç´ ** | unique_ptr | shared_ptrï¼ˆé™¤ééœ€è¦å…±äº«ï¼‰ |
| **å·¥å‚æ¨¡å¼è¿”å›å€¼** | unique_ptr | shared_ptrï¼ˆé™¤ééœ€è¦å…±äº«ï¼‰ |
| **å¤šçº¿ç¨‹ç¯å¢ƒ** | - | shared_ptrï¼ˆå¼•ç”¨è®¡æ•°çº¿ç¨‹å®‰å…¨ï¼‰ |
| **å¾ªç¯æ•°æ®ç»“æ„** | - | shared_ptr + weak_ptr |
| **æ•°ç»„ç®¡ç†** | unique_ptr<T[]> | shared_ptr |

## âš ï¸ âš ï¸ âš ï¸ âš ï¸ âš ï¸ âš ï¸ âš ï¸ æ³¨æ„äº‹é¡¹

### 1. unique_ptræ³¨æ„äº‹é¡¹

- **ç¦æ­¢æ‹·è´**ï¼šä¸è¦å°è¯•æ‹·è´unique_ptrï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯
- **ç§»åŠ¨åçŠ¶æ€**ï¼šç§»åŠ¨åçš„unique_ptrå¤„äºæœ‰æ•ˆä½†æœªå®šä¹‰çš„çŠ¶æ€ï¼Œä¸åº”å†ä½¿ç”¨
- **æ•°ç»„æ”¯æŒ**ï¼šä½¿ç”¨unique_ptr<T[]>ç®¡ç†æ•°ç»„ï¼Œè‡ªåŠ¨è°ƒç”¨delete[]
- **è‡ªå®šä¹‰åˆ é™¤å™¨**ï¼šå¯ä»¥æŒ‡å®šè‡ªå®šä¹‰åˆ é™¤å™¨ï¼Œç”¨äºç®¡ç†ç‰¹æ®Šèµ„æº
- **release()çš„ä½¿ç”¨**ï¼šrelease()è¿”å›çš„åŸå§‹æŒ‡é’ˆéœ€è¦æ‰‹åŠ¨ç®¡ç†ï¼Œæˆ–ä¼ é€’ç»™å¦ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆ

### 2. shared_ptræ³¨æ„äº‹é¡¹

- **å¾ªç¯å¼•ç”¨**ï¼šä¸¤ä¸ªæˆ–å¤šä¸ªshared_pträº’ç›¸å¼•ç”¨ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼Œéœ€è¦ä½¿ç”¨weak_ptrè§£å†³
- **æ€§èƒ½å¼€é”€**ï¼šå¼•ç”¨è®¡æ•°çš„å¢å‡ä¼šå¸¦æ¥æ€§èƒ½å¼€é”€ï¼Œé¢‘ç¹æ‹·è´æ—¶éœ€æ³¨æ„
- **çº¿ç¨‹å®‰å…¨**ï¼šshared_ptræœ¬èº«ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªæœ‰å¼•ç”¨è®¡æ•°çš„å¢å‡æ˜¯çº¿ç¨‹å®‰å…¨çš„
- **è‡ªå®šä¹‰åˆ é™¤å™¨**ï¼šå¯ä»¥æŒ‡å®šè‡ªå®šä¹‰åˆ é™¤å™¨ï¼Œç”¨äºç®¡ç†ç‰¹æ®Šèµ„æº
- **make_sharedçš„ä½¿ç”¨**ï¼šä¼˜å…ˆä½¿ç”¨make_sharedåˆ›å»ºshared_ptrï¼Œæ›´é«˜æ•ˆ
- **é¿å…è£¸æŒ‡é’ˆ**ï¼šä¸è¦å°†åŒä¸€ä¸ªè£¸æŒ‡é’ˆèµ‹å€¼ç»™å¤šä¸ªshared_ptrï¼Œä¼šå¯¼è‡´åŒé‡é‡Šæ”¾

### 3. å…±åŒæ³¨æ„äº‹é¡¹

- **ä¸è¦æ‰‹åŠ¨é‡Šæ”¾èµ„æº**ï¼šæ™ºèƒ½æŒ‡é’ˆä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œæ‰‹åŠ¨é‡Šæ”¾ä¼šå¯¼è‡´åŒé‡é‡Šæ”¾
- **é¿å…æ‚¬ç©ºæŒ‡é’ˆ**ï¼šä¸è¦ä¿å­˜æ™ºèƒ½æŒ‡é’ˆç®¡ç†çš„åŸå§‹æŒ‡é’ˆï¼Œå¯èƒ½å¯¼è‡´æ‚¬ç©ºæŒ‡é’ˆ
- **æ³¨æ„ä½œç”¨åŸŸ**ï¼šæ™ºèƒ½æŒ‡é’ˆç¦»å¼€ä½œç”¨åŸŸæ—¶ä¼šè‡ªåŠ¨é‡Šæ”¾èµ„æº
- **ä¸è¦ä¸è£¸æŒ‡é’ˆæ··ç”¨**ï¼šå°½é‡é¿å…å°†æ™ºèƒ½æŒ‡é’ˆä¸è£¸æŒ‡é’ˆæ··ç”¨ï¼Œå®¹æ˜“å¯¼è‡´é”™è¯¯
- **æ³¨æ„å¼‚å¸¸å®‰å…¨**ï¼šæ™ºèƒ½æŒ‡é’ˆèƒ½ä¿è¯å¼‚å¸¸æƒ…å†µä¸‹èµ„æºçš„æ­£ç¡®é‡Šæ”¾

## ğŸ“ æ€»ç»“

### 1. é€‰æ‹©å»ºè®®

- **ä¼˜å…ˆä½¿ç”¨unique_ptr**ï¼šå½“èµ„æºåªéœ€ç‹¬å æ‰€æœ‰æƒæ—¶ï¼Œunique_ptræ˜¯æœ€ä½³é€‰æ‹©ï¼Œæ€§èƒ½æ›´é«˜
- **ä½¿ç”¨shared_ptr**ï¼šå½“èµ„æºéœ€è¦å…±äº«æ‰€æœ‰æƒæ—¶ï¼Œä½¿ç”¨shared_ptr
- **é¿å…ä¸å¿…è¦çš„å…±äº«**ï¼šå…±äº«ä¼šå¸¦æ¥å¼•ç”¨è®¡æ•°å¼€é”€ï¼Œå°½é‡ä½¿ç”¨unique_ptr
- **ä½¿ç”¨make_uniqueå’Œmake_shared**ï¼šæ›´å®‰å…¨ã€æ›´é«˜æ•ˆåœ°åˆ›å»ºæ™ºèƒ½æŒ‡é’ˆ

### 2. æœ€ä½³å®è·µ

```cpp
// æ¨èä½¿ç”¨make_uniqueå’Œmake_sharedåˆ›å»ºæ™ºèƒ½æŒ‡é’ˆ
auto up = make_unique<MyClass>();
auto sp = make_shared<MyClass>();

// ç¦æ­¢å°†åŒä¸€ä¸ªè£¸æŒ‡é’ˆèµ‹å€¼ç»™å¤šä¸ªshared_ptr
MyClass* raw = new MyClass();
shared_ptr<MyClass> sp1(raw);
// shared_ptr<MyClass> sp2(raw);  // é”™è¯¯ï¼šä¼šå¯¼è‡´åŒé‡é‡Šæ”¾

// é¿å…å¾ªç¯å¼•ç”¨
class A {
public:
    shared_ptr<B> b_ptr;
};
class B {
public:
    shared_ptr<A> a_ptr;
};
// æ”¹ä¸ºä½¿ç”¨weak_ptr
class A {
public:
    shared_ptr<B> b_ptr;
};
class B {
public:
    weak_ptr<A> a_ptr;  // ä½¿ç”¨weak_ptré¿å…å¾ªç¯å¼•ç”¨
};

// ä½¿ç”¨unique_ptrç®¡ç†æ•°ç»„
unique_ptr<int[]> arr(new int[10]);
arr[0] = 42;
arr[1] = 100;
```

### 3. æ ¸å¿ƒè¦ç‚¹å›é¡¾

- **unique_ptr**ï¼šç‹¬å æ‰€æœ‰æƒï¼Œæ— å¼•ç”¨è®¡æ•°ï¼Œæ€§èƒ½é«˜ï¼Œæ”¯æŒç§»åŠ¨è¯­ä¹‰
- **shared_ptr**ï¼šå…±äº«æ‰€æœ‰æƒï¼Œæœ‰å¼•ç”¨è®¡æ•°ï¼Œæ€§èƒ½è¾ƒä½ï¼Œæ”¯æŒæ‹·è´è¯­ä¹‰
- **é€‰æ‹©ä¾æ®**ï¼šæ ¹æ®èµ„æºæ‰€æœ‰æƒéœ€æ±‚é€‰æ‹©åˆé€‚çš„æ™ºèƒ½æŒ‡é’ˆ
- **é¿å…å¸¸è§é”™è¯¯**ï¼šå¾ªç¯å¼•ç”¨ã€è£¸æŒ‡é’ˆæ··ç”¨ã€æ‰‹åŠ¨é‡Šæ”¾èµ„æº
- **ä¼˜å…ˆä½¿ç”¨å·¥å‚å‡½æ•°**ï¼šmake_uniqueå’Œmake_sharedæ›´å®‰å…¨é«˜æ•ˆ

é€šè¿‡åˆç†é€‰æ‹©å’Œä½¿ç”¨unique_ptrå’Œshared_ptrï¼Œå¯ä»¥å®ç°å®‰å…¨ã€é«˜æ•ˆçš„å†…å­˜ç®¡ç†ï¼Œé¿å…å†…å­˜æ³„æ¼å’Œå…¶ä»–å†…å­˜ç›¸å…³é—®é¢˜ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œåº”æ ¹æ®å…·ä½“åœºæ™¯å’Œéœ€æ±‚é€‰æ‹©åˆé€‚çš„æ™ºèƒ½æŒ‡é’ˆï¼Œéµå¾ªæœ€ä½³å®è·µï¼Œç¼–å†™é«˜è´¨é‡çš„C++ä»£ç ã€‚